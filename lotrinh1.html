<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title data-i18n="dest_museum">Báº£o tÃ ng Chiáº¿n tÃ­ch Chiáº¿n tranh</title>
    <link rel="stylesheet" href="./assets/css/style.css" />
    <link rel="stylesheet" href="./assets/css/i18n.css" />
    <link rel="stylesheet" href="./assets/css/route1.css">
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700;800&display=swap" rel="stylesheet">

</head>
<body>
    <header class="header">
  <div class="container">
    <div style="
        display: inline-block;
        padding: 12px 30px;
        border: 3px solid #f1f1f1;
        border-radius: 12px;
        background-color: rgb(167, 205, 246);
        box-shadow: 0 4px 10px rgba(152, 193, 236, 0.2);
        font-size: 2.4rem;
        font-weight: 800;
        color: #040c69;
        text-transform: uppercase;
        font-family: 'Times New Roman', Times, serif;
      " data-i18n="dest_route_1">
      Lá»™ trÃ¬nh 1
    </div>
    
    <a href="index.html" class="btn btn-outline" data-i18n="btn_back_home">â† Quay láº¡i trang chÃ­nh</a>
  </div>
</header>

    <main class="container">
        <section class="museum-section" style="display: flex; align-items: center; justify-content: center; gap: 40px; margin: 50px auto; max-width: 1100px; flex-wrap: wrap;">
            <div class="museum-image" style="flex: 1; text-align: center;">
                <img
                    src="./assets/images/BTCTCT.png"
                    data-i18n-alt="dest_museum"
                    alt="Báº£o tÃ ng Chiáº¿n tÃ­ch Chiáº¿n tranh"
                    style="
                        width: 100%;
                        max-width: 480px;
                        border-radius: 12px;
                        box-shadow: 0 4px 10px rgba(0,0,0,0.2);
                    "
                />
            </div>

            <div class="museum-info" style="flex: 1; min-width: 320px;">
                <h2 style="
                  display: inline-block;
                  padding: 10px 25px;
                  border: 2px solid #ff6600;
                  border-radius: 10px;
                  background-color: rgba(255, 102, 0, 0.1);
                  box-shadow: 0 4px 10px rgba(255, 102, 0, 0.2);
                  font-size: 2rem;
                  font-weight: 800;
                  color: #e65c00;
                  margin-bottom: 25px;
                  font-family: 'Times New Roman', Times, serif;
                  " data-i18n="route1_intro_title">
                  Giá»›i thiá»‡u sÆ¡ lÆ°á»£c vá» lá»™ trÃ¬nh 1
                </h2>

                <p style="font-size: 1.6rem; color: #444; line-height: 1.8; text-align: justify;" data-i18n="route1_intro_text">
                    Lá»™ trÃ¬nh sáº½ xuáº¥t phÃ¡t tá»« <b>Báº£o tÃ ng Chiáº¿n tÃ­ch Chiáº¿n tranh</b> táº¡i sá»‘ <b>28 VÃµ VÄƒn Táº§n, Quáº­n 3, TP. Há»“ ChÃ­ Minh</b>.
                    Láº§n lÆ°á»£t Ä‘i qua cÃ¡c Ä‘á»‹a Ä‘iá»ƒm ná»•i báº­t trong thÃ nh phá»‘ nhÆ° <b>Dinh Äá»™c Láº­p</b>, <b>CÃ´ng viÃªn 30/4</b>, <b>NhÃ  thá» Äá»©c BÃ </b>, <b>BÆ°u Ä‘iá»‡n ThÃ nh phá»‘</b>, <b>ÄÆ°á»ng sÃ¡ch Nguyá»…n VÄƒn BÃ¬nh</b>, <b>Há»“ con rÃ¹a</b>. Tá»« Ä‘Ã³, 
                    giÃºp du khÃ¡ch khÃ¡m phÃ¡ lá»‹ch sá»­, vÄƒn hÃ³a vÃ  kiáº¿n trÃºc Ä‘á»™c Ä‘Ã¡o cá»§a SÃ i GÃ²n.
                </p>
            </div>
        </section>

        <section class="next-destinations" style="text-align: center; margin-top: 60px;">
            <h2 style="
                  display: inline-block;
                  padding: 10px 25px;
                  border: 2px solid #ff6600;
                  border-radius: 10px;
                  background-color: rgba(255, 102, 0, 0.1);
                  box-shadow: 0 4px 10px rgba(255, 102, 0, 0.2);
                  font-size: 2rem;
                  font-weight: 800;
                  color: #e65c00;
                  margin-bottom: 25px;
                  font-family: 'Times New Roman', Times, serif;
                  " data-i18n="route1_next_dest_title">
                  Nhá»¯ng Ä‘á»‹a Ä‘iá»ƒm tiáº¿p theo trong lá»™ trÃ¬nh
                </h2>

  <div class="destination-grid" style="
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 30px;
    justify-items: center;
    align-items: start;
    max-width: 900px;
    margin: 0 auto;
  ">

    <div class="destination-item" style="text-align: center;">
      <div style="
        width: 100%;
        aspect-ratio: 4/3;
        overflow: hidden;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      ">
        <img src="./assets/images/DinhDocLap.jpg" data-i18n-alt="dest_palace" alt="Dinh Äá»™c Láº­p" style="
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.3s ease;
        ">
      </div>
      <p style="margin-top: 12px; font-size: 1.05rem; color: #444; font-weight: 700;" data-i18n="dest_palace">Dinh Äá»™c Láº­p</p>
    </div>

    <div class="destination-item" style="text-align: center;">
      <div style="
        width: 100%;
        aspect-ratio: 4/3;
        overflow: hidden;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      ">
        <img src="./assets/images/cv30th4.jpg" data-i18n-alt="dest_park" alt="CÃ´ng viÃªn 30/4" style="
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.3s ease;
        ">
      </div>
      <p style="margin-top: 12px; font-size: 1.05rem; color: #444; font-weight: 700;" data-i18n="dest_park">CÃ´ng viÃªn 30/4</p>
    </div>

    <div class="destination-item" style="text-align: center;">
      <div style="
        width: 100%;
        aspect-ratio: 4/3;
        overflow: hidden;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      ">
        <img src="./assets/images/NhaThoDucBa.jpg" data-i18n-alt="dest_cathedral" alt="NhÃ  thá» Äá»©c BÃ " style="
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.3s ease;
        ">
      </div>
      <p style="margin-top: 12px; font-size: 1.05rem; color: #444; font-weight: 700;" data-i18n="dest_cathedral">NhÃ  thá» Äá»©c BÃ </p>
    </div>

    <div class="destination-item" style="text-align: center;">
      <div style="
        width: 100%;
        aspect-ratio: 4/3;
        overflow: hidden;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      ">
        <img src="./assets/images/BuuDienTP.png" data-i18n-alt="dest_post_office" alt="BÆ°u Ä‘iá»‡n ThÃ nh phá»‘" style="
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.3s ease;
        ">
      </div>
      <p style="margin-top: 12px; font-size: 1.05rem; color: #444; font-weight: 700;" data-i18n="dest_post_office">BÆ°u Ä‘iá»‡n ThÃ nh phá»‘</p>
    </div>

    <div class="destination-item" style="text-align: center;">
      <div style="
        width: 100%;
        aspect-ratio: 4/3;
        overflow: hidden;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      ">
        <img src="./assets/images/DuongSachNVB.jpg" data-i18n-alt="dest_book_street" alt="ÄÆ°á»ng sÃ¡ch Nguyá»…n VÄƒn BÃ¬nh" style="
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.3s ease;
        ">
      </div>
      <p style="margin-top: 12px; font-size: 1.05rem; color: #444; font-weight: 700;" data-i18n="dest_book_street">ÄÆ°á»ng sÃ¡ch Nguyá»…n VÄƒn BÃ¬nh</p>
    </div>

    <div class="destination-item" style="text-align: center;">
      <div style="
        width: 100%;
        aspect-ratio: 4/3;
        overflow: hidden;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
      ">
        <img src="./assets/images/HoConRua.jpg" data-i18n-alt="dest_turtle_lake" alt="Há»“ Con RÃ¹a" style="
          width: 100%;
          height: 100%;
          object-fit: cover;
          transition: transform 0.3s ease;
        ">
      </div>
      <p style="margin-top: 12px; font-size: 1.05rem; color: #444; font-weight: 700;" data-i18n="dest_turtle_lake">Há»“ Con RÃ¹a</p>
    </div>

  </div>
</section>

        <section class="map-and-ranking"
         style="display: flex; flex-wrap: wrap; justify-content: center; align-items: flex-start; gap: 40px; margin-top: 60px;">
    
  <div class="start-point" style="flex: 1 1 500px; max-width: 600px; text-align: center;">
    <h2 style="font-size: 1.6rem; color: #222; margin-bottom: 20px;" data-i18n="route1_start_point">Äiá»ƒm xuáº¥t phÃ¡t</h2>
    <div style="width: 100%; border-radius: 12px; overflow: hidden;">
      <iframe src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d7838.822421986659!2d106.689342!3d10.779784!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x31752f30a23708cf%3A0x7cd94adf2b1474aa!2zQuG6o28gdMOgbmcgQ2jhu6luZyB0w61jaCBDaGnhur9uIHRyYW5o!5e0!3m2!1svi!2sus!4v1761832010042!5m2!1svi!2sus"
              width="100%" height="350" style="border:0;" allowfullscreen="" loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>
    <div style="margin-top: 15px;">
      <h3 style="font-size: 1.2rem; font-weight: 800;" data-i18n="dest_museum">Báº£o tÃ ng Chiáº¿n tÃ­ch Chiáº¿n tranh</h3>
      <p style="color: #555;" data-i18n="addr_museum">28 VÃµ VÄƒn Táº§n, PhÆ°á»ng 6, Quáº­n 3, TP. Há»“ ChÃ­ Minh</p>
    </div>
  </div>

  <div class="ranking" style="flex: 1 1 300px; max-width: 400px; text-align: center;">
    <h2 style="font-size: 1.5rem; color: #222;" data-i18n="route1_ranking">Xáº¿p háº¡ng</h2>
    <p id="xp-score" style="color: #ff6b00; font-weight: 600; font-size: 1.1rem; margin-top: 10px;">
        <span data-i18n="score_highest">Äiá»ƒm cao nháº¥t</span> ğŸ’ 0 XP
    </p>

    <div style="margin-top: 20px;">
      <img 
        id="treasure-chest"
        src="./assets/images/Ruong_dong.png"
        data-i18n-alt="chest_closed"
        alt="RÆ°Æ¡ng kho bÃ¡u Ä‘Ã³ng"
        data-closed-src="./assets/images/Ruong_dong.png"
        data-open-src="./assets/images/Ruong.jpeg"
        style="max-width: 250px;"
      />
    </div>

    <div class="shop-button-container" style="margin-top: 25px;">
      <a href="shop.html" class="btn-shop"
         style="display: inline-block; background-color: #007bff; color: white; padding: 12px 25px; border-radius: 10px; text-decoration: none; font-weight: 600;"
         data-i18n="btn_exchange_voucher">
        ğŸ›ï¸ Äá»•i Voucher
      </a>
    </div>
  </div>
</section>

        <hr style="margin: 40px 0; border: 0.5px solid #ddd;">

        <section class="support" tabindex="0"
                 style="
                   position: sticky;
                   bottom: 75px;
                   left: 50%;
                   transform: translateX(-50%);
                   background-color: #007bff;
                   color: white;
                   padding: 15px 20px;
                   border-radius: 12px;
                   box-shadow: 0 4px 10px rgba(0,0,0,0.2);
                   font-size: 0.95rem;
                   line-height: 1.6;
                   z-index: 100;
                   max-width: fit-content;
                   max-height: fit-content;
                 ">
            <h3 style="margin: 0; font-size: 1.05rem; font-weight: 700; display: flex; justify-content: center;" data-i18n="route1_support">ğŸ“ Há»— trá»£</h3>
            <p style="margin: 0;">
              Email: <a href="mailto:hello@ontripquest.com" style="color: #fff; font-weight: 600; text-decoration: underline;">hello@ontripquest.com</a><br>
              Hotline: <a href="tel:0906488443" style="color: #fff; font-weight: 600; text-decoration: underline;">0906 488 443</a>
            </p>
        </section>

         <div style="
          position: fixed;
          bottom: 20px;
          left: 50%;
          transform: translateX(-50%);
          z-index: 99;
          text-align: center;
        ">
            <a href="batdau1.html" class="btn btn-primary"
               style="
                 background-color: #ff6600;
                 color: white;
                 padding: 10px 70px;
                 border-radius: 14px;
                 text-decoration: none;
                 font-size: 1.4rem;
                 font-weight: 700;
                 box-shadow: 0 4px 10px rgba(0,0,0,0.25);
                 transition: all 0.25s ease;
                 display: inline-block;
               "
               onmouseover="this.style.transform='translateY(-4px)'"
               onmouseout="this.style.transform='translateY(0)'"
               data-i18n="btn_start"
            >
                ğŸš€ Báº¯t Ä‘áº§u
            </a>
          <script>
async function onStartRoute1() {
  const res = await fetch('/api/start-tour-1', { method: 'POST' });
  const data = await res.json();
  if (data.success) window.location.href = data.start_url;
  else alert(data.message);
}
</script>
        </div>
    </main>

    <div id="toast-notification" data-i18n="route1_toast_default">ÄÃ¢y lÃ  thÃ´ng bÃ¡o cá»§a báº¡n!</div>

<script>
    const chestImage = document.getElementById('treasure-chest');
    const toast = document.getElementById('toast-notification');
    const xpScoreElement = document.getElementById('xp-score');
    
    const closedSrc = chestImage.getAttribute('data-closed-src');
    const openSrc = chestImage.getAttribute('data-open-src');
    
    let isRouteCompleted = false;
    let isRewardClaimed = false;

    // 1. Khi load trang, kiá»ƒm tra tráº¡ng thÃ¡i
    window.addEventListener('load', async () => {
        try {
            const res = await fetch('/api/user');
            const data = await res.json();
            
            if (data.logged_in) {
                const route1 = data.routes && data.routes['route1'];
                
                // Máº·c Ä‘á»‹nh luÃ´n Ä‘á»ƒ rÆ°Æ¡ng mÃ u sáº¯c bÃ¬nh thÆ°á»ng (khÃ´ng lÃ m xÃ¡m)
                chestImage.style.filter = "none"; 
                chestImage.style.cursor = "pointer"; // LuÃ´n cho phÃ©p trá» chuá»™t vÃ o

                if (route1 && route1.status === 'completed') {
                    isRouteCompleted = true;
                    isRewardClaimed = route1.reward_claimed;

                    if (isRewardClaimed) {
                        // ÄÃ£ nháº­n thÆ°á»Ÿng -> Hiá»‡n rÆ°Æ¡ng má»Ÿ
                        chestImage.src = openSrc;
                        chestImage.style.cursor = 'default';
                        
                        const scoreCurrentText = i18n.t('score_current');
                        xpScoreElement.innerHTML = `${scoreCurrentText} ğŸ’ ${data.points} XP`;
                    } else {
                        // Xong nhiá»‡m vá»¥ nhÆ°ng chÆ°a má»Ÿ -> RÆ°Æ¡ng Ä‘Ã³ng + Rung láº¯c
                        chestImage.src = closedSrc;
                        chestImage.style.animation = 'shake 0.5s infinite'; 
                    }
                } else {
                    // ChÆ°a xong nhiá»‡m vá»¥ -> Váº«n hiá»‡n rÆ°Æ¡ng Ä‘Ã³ng (nhÆ°ng cÃ³ mÃ u Ä‘áº¹p)
                    chestImage.src = closedSrc;
                    // Bá» dÃ²ng grayscale(100%) Ä‘á»ƒ khÃ´ng bá»‹ xÃ¡m
                    chestImage.style.animation = 'none';
                }
            }
        } catch (e) { console.error(e); }
    });

    // 2. Xá»­ lÃ½ click rÆ°Æ¡ng
    chestImage.addEventListener('click', async () => {
        // Náº¿u chÆ°a xong lá»™ trÃ¬nh -> Chá»‰ hiá»‡n thÃ´ng bÃ¡o (hoáº·c khÃ´ng lÃ m gÃ¬ náº¿u báº¡n muá»‘n im láº·ng)
        if (!isRouteCompleted) {
            alert(i18n.t('route1_chest_locked')); 
            return;
        }

        // Náº¿u Ä‘Ã£ nháº­n rá»“i -> KhÃ´ng lÃ m gÃ¬ hoáº·c bÃ¡o Ä‘Ã£ nháº­n
        if (isRewardClaimed) {
            return; 
        }

        // Gá»i API nháº­n thÆ°á»Ÿng
        try {
            const res = await fetch('/api/claim-reward', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ routeId: 'route1', points: 50 })
            });
            
            const data = await res.json();
            
            if (data.success) {
                // --- ÄÃ‚Y LÃ€ HIá»†U á»¨NG Má» RÆ¯Æ NG ---
                chestImage.src = openSrc;       // Äá»•i áº£nh sang rÆ°Æ¡ng má»Ÿ
                chestImage.style.animation = 'none'; // Táº¯t rung
                
                // Cáº­p nháº­t Ä‘iá»ƒm
                const scoreCurrentText = i18n.t('score_current');
                xpScoreElement.innerHTML = `${scoreCurrentText} ğŸ’ ${data.newPoints} XP`;
                
                // Hiá»‡n thÃ´ng bÃ¡o nháº­n quÃ  (báº¡n cÃ³ thá»ƒ xÃ³a dÃ²ng nÃ y náº¿u khÃ´ng muá»‘n popup thÃ´ng bÃ¡o)
                alert(i18n.t('route1_chest_reward'));
                
                isRewardClaimed = true;
            } else {
                alert(data.message);
            }
        } catch (e) {
            console.error(e);
        }
    });
</script>

<style>
@keyframes shake {
  0% { transform: translate(1px, 1px) rotate(0deg); }
  10% { transform: translate(-1px, -2px) rotate(-1deg); }
  20% { transform: translate(-3px, 0px) rotate(1deg); }
  30% { transform: translate(3px, 2px) rotate(0deg); }
  40% { transform: translate(1px, -1px) rotate(1deg); }
  50% { transform: translate(-1px, 2px) rotate(-1deg); }
  60% { transform: translate(-3px, 1px) rotate(0deg); }
  70% { transform: translate(3px, 1px) rotate(-1deg); }
  80% { transform: translate(-1px, -1px) rotate(1deg); }
  90% { transform: translate(1px, 2px) rotate(0deg); }
  100% { transform: translate(1px, -2px) rotate(-1deg); }
}
</style>

<script src="./assets/js/translations.js"></script>
<script src="./assets/js/i18n.js"></script>
<link rel="stylesheet" href="./assets/js/i18n.css">

</body>
</html>